ACTOR KXPlasmaRifle : KXBaseWeapon replaces PlasmaRifle
{
    Weapon.AmmoUse2 1
    Weapon.AmmoType2 "Cell"
	Tag "Plasma Rifle"
	Inventory.PickupSound "weapons/Plasmaup"
	Weapon.UpSound "weapons/Plasmaup"
	Weapon.SelectionOrder 100
    Weapon.AmmoUse 1
	Weapon.SlotNumber 6
    Weapon.AmmoGive 40
    Weapon.AmmoType "Cell"
    Inventory.PickupMessage "$GOTPLASMA"
	States
	{
	Ready:
		PLSG A 0 A_JumpIfInventory("KXFireSkillToken", 1, "KXSkillFire") 
        PLSG A 1 A_WeaponReady
        Loop
	Deselect:
	    PLSG A 0 A_Lower
        PLSG A 1 A_Lower
        Loop
    Select:
	    PKPL G 1 Offset(-144,87)
	    FSWD A 0 A_TakeInventory("KXFireSkillToken") 
		PKPL G 1 Offset(-132,82)
		PKPL G 1 Offset(-120,77)
		PKPL F 1 Offset(-108,72)
		PKPL F 1 Offset(-96,67)
		PKPL F 1 Offset(-84,62)
		PKPL E 1 Offset(-72,57)
		PKPL E 1 Offset(-60,52)
		PKPL C 1 Offset(-48,47) 
		PKPL C 1 Offset(-36,42) 
		PKPL B 1 Offset(-24,37) 
		PKPL B 1 Offset(-12,32) 
		Goto Ready
	Fire:
		PKPL A 0 A_GunFlash
		PKPL A 0 A_PlaySound("weapons/plasmaf",CHAN_WEAPON)
		PKPL A 0 A_FireCustomMissile("KXPlayerPlasmaBall",0,1,0,0)
		PKPL A 0 Radius_Quake(1,3,0,1,0)
		PKPL A 0 A_ZoomFactor(0.9925)
		PKPL A 1 Offset(0,33) A_ZoomFactor(0.985)
		PKPL A 1 Offset(0,34) A_ZoomFactor(0.990)
		PKPL A 1 Offset(0,33) A_ZoomFactor(0.995)
		PKPL B 0 A_ReFire
		PKPL B 1 A_ZoomFactor(1.00)
		PKPL DEF 1
		PKPL GF 3
		PKPL EDCBA 2
		Goto Ready
	Flash:
		TNT1 A 0 A_Jump(256,"Flash1","Flash2","Flash3","Flash4","Flash5","Flash6")
	Flash1:
		PLSF B 2 Bright A_Light1
		PLSF A 1 Bright A_Light1
		TNT1 A 1 Bright A_Light1
		Goto LightDone
	Flash2:
		PLSF C 2 Bright A_Light1
		PLSF D 1 Bright A_Light1
		TNT1 A 1 Bright A_Light1
		Goto LightDone
	Flash3:
		PLSF B 1 Bright A_Light1
		PLSF A 1 Bright A_Light1
		TNT1 A 2 Bright A_Light1
		Goto LightDone
	Flash4:
		PLSF C 1 Bright A_Light1
		PLSF D 1 Bright A_Light1
		TNT1 A 2 Bright A_Light1
		Goto LightDone
	Flash5:
		PLSF B 1 Bright A_Light1
		TNT1 A 3 Bright A_Light1
		Goto LightDone
	Flash6:
		PLSF C 1 Bright A_Light1
		TNT1 A 3 Bright A_Light1
		Goto LightDone
   AltFire:
		PLSF A 0 A_JumpIfInventory("PlasmaRifleUpgrade", 1, "Alternative")
		Goto Ready
   Alternative:
		PKPL A 0 A_GunFlash
		PKPL A 0 A_FireCustomMissile("PlasmaBall", 15, 1, 0, 0)
		PKPL A 0 A_FireCustomMissile("PlasmaBall", -15, 1, 0, 0)
		PKPL A 3 A_FireCustomMissile("PlasmaBall", 0, 1, 0, 0)
		PKPL B 1 A_ReFire
		PKPL DEF 1
		PKPL GF 3
		PKPL EDCBA 2
		Goto Ready
   Spawn:
        PLAS A -1
        Stop
	KXSkillLower:
        FSWD A 1 bright Offset(0,40)
	    FSWD A 1 bright Offset(0,50)
	    FSWD B 1 bright Offset(0,60)
	    FSWD B 1 bright Offset(0,70)
		PLSG A 1 bright Offset(0,70)
	    PLSG A 1 bright Offset(0,60)
	    PLSG A 1 bright Offset(0,50)
	    PLSG A 1 bright Offset(0,40)
		Goto Ready
	}
}

actor KXPlayerPlasmaBall : KXPlasmaBall
{
  Speed 60
  SeeSound ""
}